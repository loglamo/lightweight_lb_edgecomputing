from kafka import KafkaConsumer, KafkaProducer                                                                                                                                                         
import sys                                                                                                                                                                                             
import jsons                                                                                                                                                                                           
from json import loads                                                                                                                                                                                                                                                                                                                                                                                         
bootstrap_servers = ['165.194.35.81:9092']                                                                                                                                                             
topic0 = ['users_requests0','users_requests1']                                                                                                                                                         
consumer0 = KafkaConsumer(client_id='local_test', bootstrap_servers = bootstrap_servers, auto_offset_reset = 'latest', value_deserializer=lambda x: loads(x.decode('utf-8')))                          
consumer0.subscribe(topics=topic0)                                                                                                                                                                     
# read messages                                                                                                                                                                                        
def readMessage():                                                                                                                                                                                     
      while True:                                                                                                                                                                                        
          print('Polling...')                                                                                                                                                                            
          records = consumer0.poll(timeout_ms=10000)                                                                                                                                                     
          for _,consumer_records in records.items():                                                                                                                                                     
              for consumer_record in consumer_records:                                                                                                                                                   
                  print(consumer_record.value)                                                                                                                                                           
              continue   
if __name__ == '__main__':
     readMessage()                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
